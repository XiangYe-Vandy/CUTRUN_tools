B2_sample_ID <- c("T0hr_K27ac_A",
"T0hr_K27ac_B",
"T0hr_K27me3_A",
"T0hr_K27me3_B",
#"T0hr_IgG",
"T4hr_CTL_K27ac_A",
"T4hr_CTL_K27ac_B",
"T4hr_CTL_K27me3_A",
"T4hr_CTL_K27me3_B",
#"T4hr_CTL_IgG",
"T4hr_CB839_K27ac_A",
"T4hr_CB839_K27ac_B",
"T4hr_CB839_K27me3_A",
"T4hr_CB839_K27me3_B",
#"T4hr_CB839_IgG",
"T4hr_DON_K27ac_A",
"T4hr_DON_K27ac_B",
"T4hr_DON_K27me3_A",
"T4hr_DON_K27me3_B",
#"T4hr_DON_IgG",
"T4hr_NoQ_K27ac_A",
"T4hr_NoQ_K27ac_B",
"T4hr_NoQ_K27me3_A",
"T4hr_NoQ_K27me3_B",
#"T4hr_NoQ_IgG",
"T24hr_CTL_K27ac_A",
"T24hr_CTL_K27ac_B",
"T24hr_CTL_K27me3_A",
"T24hr_CTL_K27me3_B",
#"T24hr_CTL_IgG",
"T24hr_CB839_K27ac_A",
"T24hr_CB839_K27ac_B",
"T24hr_CB839_K27me3_A",
"T24hr_CB839_K27me3_B",
#"T24hr_CB839_IgG",
"T24hr_DON_K27ac_A",
"T24hr_DON_K27ac_B",
"T24hr_DON_K27me3_A",
"T24hr_DON_K27me3_B",
#"T24hr_DON_IgG",
"T24hr_NoQ_K27ac_A",
"T24hr_NoQ_K27ac_B",
"T24hr_NoQ_K27me3_A",
"T24hr_NoQ_K27me3_B",
#"T24hr_NoQ_IgG",
"T48hr_CTL_K27ac_A",
"T48hr_CTL_K27ac_B",
"T48hr_CTL_K27me3_A",
"T48hr_CTL_K27me3_B",
#"T48hr_CTL_IgG",
"T48hr_CB839_K27ac_A",
"T48hr_CB839_K27ac_B",
"T48hr_CB839_K27me3_A",
"T48hr_CB839_K27me3_B",
#"T48hr_CB839_IgG",
"T48hr_DON_K27ac_A",
"T48hr_DON_K27ac_B",
"T48hr_DON_K27me3_A",
"T48hr_DON_K27me3_B",
#"T48hr_DON_IgG",
"T48hr_NoQ_K27ac_A",
"T48hr_NoQ_K27ac_B",
"T48hr_NoQ_K27me3_A",
"T48hr_NoQ_K27me3_B"#,
#"T48hr_NoQ_IgG"
)
B1_epi_signalFiles <- paste0(BAM_DIR, "/", B1_cutrunbamFiles)
B2_epi_signalFiles <- paste0(BAM_DIR, "/", B2_cutrunbamFiles)
all_epi_signal <- c(B1_epi_signalFiles, B2_epi_signalFiles)
all_sampleID <- c(B1_sample_ID, B2_sample_ID)
all_peaks <- c("T0hr_CTL_H3K4me3_A_peaks.bed", "T0hr_CTL_H3K4me3_B_peaks.bed",
"T0hr_CTL_H3K27me3_A_peaks.bed", "T0hr_CTL_H3K27me3_B_peaks.bed",
"T0hr_CTL_H3K27ac_A_peaks.bed", "T0hr_CTL_H3K27ac_B_peaks.bed",
"T0.5hr_CTL_H3K4me3_A_peaks.bed", "T0.5hr_CTL_H3K4me3_B_peaks.bed",
"T0.5hr_CTL_H3K27me3_A_peaks.bed", "T0.5hr_CTL_H3K27me3_B_peaks.bed",
"T0.5hr_CTL_H3K27ac_A_peaks.bed", "T0.5hr_CTL_H3K27ac_B_peaks.bed",
"T4hr_CTL_H3K4me3_A_peaks.bed", "T4hr_CTL_H3K4me3_B_peaks.bed",
"T4hr_CTL_H3K27me3_A_peaks.bed",
"T4hr_CTL_H3K27ac_A_peaks.bed", "T4hr_CTL_H3K27ac_B_peaks.bed",
"T24hr_CTL_H3K4me3_A_peaks.bed", "T24hr_CTL_H3K4me3_B_peaks.bed",
"T24hr_CTL_H3K27me3_A_peaks.bed", "T24hr_CTL_H3K27me3_B_peaks.bed",
"T24hr_CTL_H3K27ac_A_peaks.bed", "T24hr_CTL_H3K27ac_B_peaks.bed",
"T48hr_CTL_H3K4me3_A_peaks.bed", "T48hr_CTL_H3K4me3_B_peaks.bed",
"T48hr_CTL_H3K27me3_A_peaks.bed", "T48hr_CTL_H3K27me3_B_peaks.bed",
"T48hr_CTL_H3K27ac_A_peaks.bed", "T48hr_CTL_H3K27ac_B_peaks.bed",
"T0hr_CTL_b2_H3K27ac_A_peaks.bed", "T0hr_CTL_b2_H3K27ac_B_peaks.bed",
"T0hr_CTL_b2_H3K27me3_A_peaks.bed", "T0hr_CTL_b2_H3K27me3_B_peaks.bed",
"T4hr_CTL_b2_H3K27ac_A_peaks.bed", "T4hr_CTL_b2_H3K27ac_B_peaks.bed",
"T4hr_CTL_b2_H3K27me3_A_peaks.bed", "T4hr_CTL_b2_H3K27me3_B_peaks.bed",
"T4hr_CB839_b2_H3K27ac_A_peaks.bed", "T4hr_CB839_b2_H3K27ac_B_peaks.bed",
"T4hr_CB839_b2_H3K27me3_A_peaks.bed", "T4hr_CB839_b2_H3K27me3_B_peaks.bed",
"T4hr_DON_b2_H3K27ac_A_peaks.bed", "T4hr_DON_b2_H3K27ac_B_peaks.bed",
"T4hr_DON_b2_H3K27me3_A_peaks.bed", "T4hr_DON_b2_H3K27me3_B_peaks.bed",
"T4hr_NoQ_b2_H3K27ac_A_peaks.bed", "T4hr_NoQ_b2_H3K27ac_B_peaks.bed",
"T4hr_NoQ_b2_H3K27me3_A_peaks.bed", "T4hr_NoQ_b2_H3K27me3_B_peaks.bed",
"T24hr_CTL_b2_H3K27ac_A_peaks.bed", "T24hr_CTL_b2_H3K27ac_B_peaks.bed",
"T24hr_CTL_b2_H3K27me3_A_peaks.bed", "T24hr_CTL_b2_H3K27me3_B_peaks.bed",
"T24hr_CB839_b2_H3K27ac_A_peaks.bed", "T24hr_CB839_b2_H3K27ac_B_peaks.bed",
"T24hr_CB839_b2_H3K27me3_A_peaks.bed", "T24hr_CB839_b2_H3K27me3_B_peaks.bed",
"T24hr_DON_b2_H3K27ac_A_peaks.bed", "T24hr_DON_b2_H3K27ac_B_peaks.bed",
"T24hr_DON_b2_H3K27me3_A_peaks.bed", "T24hr_DON_b2_H3K27me3_B_peaks.bed",
"T24hr_NoQ_b2_H3K27ac_A_peaks.bed", "T24hr_NoQ_b2_H3K27ac_B_peaks.bed",
"T24hr_NoQ_b2_H3K27me3_A_peaks.bed", "T24hr_NoQ_b2_H3K27me3_B_peaks.bed",
"T48hr_CTL_b2_H3K27ac_A_peaks.bed", "T48hr_CTL_b2_H3K27ac_B_peaks.bed",
"T48hr_CTL_b2_H3K27me3_A_peaks.bed", "T48hr_CTL_b2_H3K27me3_B_peaks.bed",
"T48hr_CB839_b2_H3K27ac_A_peaks.bed", "T48hr_CB839_b2_H3K27ac_B_peaks.bed",
"T48hr_CB839_b2_H3K27me3_A_peaks.bed", "T48hr_CB839_b2_H3K27me3_B_peaks.bed",
"T48hr_DON_b2_H3K27ac_A_peaks.bed", "T48hr_DON_b2_H3K27ac_B_peaks.bed",
"T48hr_DON_b2_H3K27me3_A_peaks.bed", "T48hr_DON_b2_H3K27me3_B_peaks.bed",
"T48hr_NoQ_b2_H3K27ac_A_peaks.bed", "T48hr_NoQ_b2_H3K27ac_B_peaks.bed",
"T48hr_NoQ_b2_H3K27me3_A_peaks.bed", "T48hr_NoQ_b2_H3K27me3_B_peaks.bed")
all_peaks <- paste0("/home/xiang/DNA_seq/CD8_CUTRUN/all_ChIPseq_aligned/", all_peaks)
CD8_CUTRUN_exp <- data.frame(SampleID = all_sampleID,
bamReads = all_epi_signal,
Timepoints = c(rep(c(0, 0.5), each = 6),
rep(4, 5),
rep(24, 6),
rep(48, 6),
rep(0, 4),
rep(4, 16),
rep(24, 16),
rep(48, 16)),
Treatment = c(rep("CTL", 29),
rep("CTL", 8),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4),
rep("CTL", 4),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4),
rep("CTL", 4),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4)),
Factor = c("H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K27ac", "H3K27ac", "H3K27me3", "H3K27me3",
"H3K27ac", "H3K27ac", "H3K27me3", "H3K27me3"),
Peaks = all_peaks)
write.csv(CD8_CUTRUN_exp, file = "CD8_CUTRUN_exp.csv", row.names = FALSE)
CD8_CUTRUN_exp <- data.frame(SampleID = all_sampleID,
bamReads = all_epi_signal,
Timepoints = c(rep(c(0, 0.5), each = 6),
rep(4, 5),
rep(24, 6),
rep(48, 6),
rep(0, 4),
rep(4, 16),
rep(24, 16),
rep(48, 16)),
Treatment = c(rep("CTL", 29),
rep("CTL", 8),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4),
rep("CTL", 4),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4),
rep("CTL", 4),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4)),
Factor = c("H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K27ac", "H3K27ac", "H3K27me3", "H3K27me3",
"H3K27ac", "H3K27ac", "H3K27me3", "H3K27me3"),
replicates = c(1,2, 1,2, 1,2,
1,2, 1,2, 1,2,
1,2, 1,   1,2,
1,2, 1,2, 1,2,
1,2, 1,2,
1,2, 1,2)
Peaks = all_peaks)
CD8_CUTRUN_exp <- data.frame(SampleID = all_sampleID,
bamReads = all_epi_signal,
Timepoints = c(rep(c(0, 0.5), each = 6),
rep(4, 5),
rep(24, 6),
rep(48, 6),
rep(0, 4),
rep(4, 16),
rep(24, 16),
rep(48, 16)),
Treatment = c(rep("CTL", 29),
rep("CTL", 8),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4),
rep("CTL", 4),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4),
rep("CTL", 4),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4)),
Factor = c("H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K27ac", "H3K27ac", "H3K27me3", "H3K27me3",
"H3K27ac", "H3K27ac", "H3K27me3", "H3K27me3"),
replicates = c(1,2, 1,2, 1,2,
1,2, 1,2, 1,2,
1,2, 1,   1,2,
1,2, 1,2, 1,2,
1,2, 1,2,
1,2, 1,2),
Peaks = all_peaks)
write.csv(CD8_CUTRUN_exp, file = "CD8_CUTRUN_exp.csv", row.names = FALSE)
samplesQC <- readRDS(file = "CD8_CUTRUN_samplesQC.rds")
data(samplesQC)
samplesQC
ChIPQCreport(samplesQC)
BAM_DIR <- "/home/xiang/DNA_seq/CD8_CUTRUN/all_ChIPseq_aligned"
# input
B1_cutrunbamFiles <- c(#"6781-MM-1.filteredChr.bam", # IgG
"6781-MM-2.filteredChr.bam",
"6781-MM-3.filteredChr.bam",
"6781-MM-4.filteredChr.bam",
"6781-MM-5.filteredChr.bam",
"6781-MM-6.filteredChr.bam",
"6781-MM-7.filteredChr.bam",
#"6781-MM-8.filteredChr.bam", # IgG
"6781-MM-9.filteredChr.bam",
"6781-MM-10.filteredChr.bam",
"6781-MM-11.filteredChr.bam",
"6781-MM-12.filteredChr.bam",
"6781-MM-13.filteredChr.bam",
"6781-MM-14.filteredChr.bam",
#"6781-MM-15.filteredChr.bam", #IgG
"6781-MM-16.filteredChr.bam",
"6781-MM-17.filteredChr.bam",
"6781-MM-18.filteredChr.bam",
# sample 19 failed
"6781-MM-20.filteredChr.bam",
"6781-MM-21.filteredChr.bam",
#"6781-MM-22.filteredChr.bam", # IgG
"6781-MM-23.filteredChr.bam",
"6781-MM-24.filteredChr.bam",
"6781-MM-25.filteredChr.bam",
"6781-MM-26.filteredChr.bam",
"6781-MM-27.filteredChr.bam",
"6781-MM-28.filteredChr.bam",
#"6781-MM-29.filteredChr.bam", # IgG
"6781-MM-30.filteredChr.bam",
"6781-MM-31.filteredChr.bam",
"6781-MM-32.filteredChr.bam",
"6781-MM-33.filteredChr.bam",
"6781-MM-34.filteredChr.bam",
"6781-MM-35.filteredChr.bam")
B2_cutrunbamFiles <- c("7523-MM-01.filteredChr.bam",
"7523-MM-02.filteredChr.bam",
"7523-MM-03.filteredChr.bam",
"7523-MM-04.filteredChr.bam",
# "7523-MM-05.filteredChr.bam", # IgG
"7523-MM-06.filteredChr.bam",
"7523-MM-07.filteredChr.bam",
"7523-MM-08.filteredChr.bam",
"7523-MM-09.filteredChr.bam",
#"7523-MM-10.filteredChr.bam",
"7523-MM-11.filteredChr.bam",
"7523-MM-12.filteredChr.bam",
"7523-MM-13.filteredChr.bam",
"7523-MM-14.filteredChr.bam",
#"7523-MM-15.filteredChr.bam",
"7523-MM-16.filteredChr.bam",
"7523-MM-17.filteredChr.bam",
"7523-MM-18.filteredChr.bam",
"7523-MM-19.filteredChr.bam",
#"7523-MM-20.filteredChr.bam",
"7523-MM-21.filteredChr.bam",
"7523-MM-22.filteredChr.bam",
"7523-MM-23.filteredChr.bam",
"7523-MM-24.filteredChr.bam",
#"7523-MM-25.filteredChr.bam",
"7523-MM-26.filteredChr.bam",
"7523-MM-27.filteredChr.bam",
"7523-MM-28.filteredChr.bam",
"7523-MM-29.filteredChr.bam",
#"7523-MM-30.filteredChr.bam",
"7523-MM-31.filteredChr.bam",
"7523-MM-32.filteredChr.bam",
"7523-MM-33.filteredChr.bam",
"7523-MM-34.filteredChr.bam",
#"7523-MM-35.filteredChr.bam",
"7523-MM-36.filteredChr.bam",
"7523-MM-37.filteredChr.bam",
"7523-MM-38.filteredChr.bam",
"7523-MM-39.filteredChr.bam",
#"7523-MM-40.filteredChr.bam",
"7523-MM-41.filteredChr.bam",
"7523-MM-42.filteredChr.bam",
"7523-MM-43.filteredChr.bam",
"7523-MM-44.filteredChr.bam",
#"7523-MM-45.filteredChr.bam",
"7523-MM-46.filteredChr.bam",
"7523-MM-47.filteredChr.bam",
"7523-MM-48.filteredChr.bam",
"7523-MM-49.filteredChr.bam",
#"7523-MM-50.filteredChr.bam",
"7523-MM-51.filteredChr.bam",
"7523-MM-52.filteredChr.bam",
"7523-MM-53.filteredChr.bam",
"7523-MM-54.filteredChr.bam",
#"7523-MM-55.filteredChr.bam",
"7523-MM-56.filteredChr.bam",
"7523-MM-57.filteredChr.bam",
"7523-MM-58.filteredChr.bam",
"7523-MM-59.filteredChr.bam",
#"7523-MM-60.filteredChr.bam",
"7523-MM-61.filteredChr.bam",
"7523-MM-62.filteredChr.bam",
"7523-MM-63.filteredChr.bam",
"7523-MM-64.filteredChr.bam" #,
#"7523-MM-65.filteredChr.bam"
)
B1_sample_ID <- c(#"T0hr_IgG",
"T0hr_K4me3_A",
"T0hr_K4me3_B",
"T0hr_K27me3_A",
"T0hr_K27me3_B",
"T0hr_K27ac_A",
"T0hr_K27ac_B",
#"T0.5hr_IgG",
"T0.5hr_K4me3_A",
"T0.5hr_K4me3_B",
"T0.5hr_K27me3_A",
"T0.5hr_K27me3_B",
"T0.5hr_K27ac_A",
"T0.5hr_K27ac_B",
#"T4hr_IgG",
"T4hr_K4me3_A",
"T4hr_K4me3_B",
"T4hr_K27me3_A",
# "T4hr_K27me3_B", fail duplicate
"T4hr_K27ac_A",
"T4hr_K27ac_B",
#"T24hr_IgG",
"T24hr_K4me3_A",
"T24hr_K4me3_B",
"T24hr_K27me3_A",
"T24hr_K27me3_B",
"T24hr_K27ac_A",
"T24hr_K27ac_B",
#"T48hr_IgG",
"T48hr_K4me3_A",
"T48hr_K4me3_B",
"T48hr_K27me3_A",
"T48hr_K27me3_B",
"T48hr_K27ac_A",
"T48hr_K27ac_B")
B2_sample_ID <- c("T0hr_K27ac_A",
"T0hr_K27ac_B",
"T0hr_K27me3_A",
"T0hr_K27me3_B",
#"T0hr_IgG",
"T4hr_CTL_K27ac_A",
"T4hr_CTL_K27ac_B",
"T4hr_CTL_K27me3_A",
"T4hr_CTL_K27me3_B",
#"T4hr_CTL_IgG",
"T4hr_CB839_K27ac_A",
"T4hr_CB839_K27ac_B",
"T4hr_CB839_K27me3_A",
"T4hr_CB839_K27me3_B",
#"T4hr_CB839_IgG",
"T4hr_DON_K27ac_A",
"T4hr_DON_K27ac_B",
"T4hr_DON_K27me3_A",
"T4hr_DON_K27me3_B",
#"T4hr_DON_IgG",
"T4hr_NoQ_K27ac_A",
"T4hr_NoQ_K27ac_B",
"T4hr_NoQ_K27me3_A",
"T4hr_NoQ_K27me3_B",
#"T4hr_NoQ_IgG",
"T24hr_CTL_K27ac_A",
"T24hr_CTL_K27ac_B",
"T24hr_CTL_K27me3_A",
"T24hr_CTL_K27me3_B",
#"T24hr_CTL_IgG",
"T24hr_CB839_K27ac_A",
"T24hr_CB839_K27ac_B",
"T24hr_CB839_K27me3_A",
"T24hr_CB839_K27me3_B",
#"T24hr_CB839_IgG",
"T24hr_DON_K27ac_A",
"T24hr_DON_K27ac_B",
"T24hr_DON_K27me3_A",
"T24hr_DON_K27me3_B",
#"T24hr_DON_IgG",
"T24hr_NoQ_K27ac_A",
"T24hr_NoQ_K27ac_B",
"T24hr_NoQ_K27me3_A",
"T24hr_NoQ_K27me3_B",
#"T24hr_NoQ_IgG",
"T48hr_CTL_K27ac_A",
"T48hr_CTL_K27ac_B",
"T48hr_CTL_K27me3_A",
"T48hr_CTL_K27me3_B",
#"T48hr_CTL_IgG",
"T48hr_CB839_K27ac_A",
"T48hr_CB839_K27ac_B",
"T48hr_CB839_K27me3_A",
"T48hr_CB839_K27me3_B",
#"T48hr_CB839_IgG",
"T48hr_DON_K27ac_A",
"T48hr_DON_K27ac_B",
"T48hr_DON_K27me3_A",
"T48hr_DON_K27me3_B",
#"T48hr_DON_IgG",
"T48hr_NoQ_K27ac_A",
"T48hr_NoQ_K27ac_B",
"T48hr_NoQ_K27me3_A",
"T48hr_NoQ_K27me3_B"#,
#"T48hr_NoQ_IgG"
)
B1_epi_signalFiles <- paste0(BAM_DIR, "/", B1_cutrunbamFiles)
B2_epi_signalFiles <- paste0(BAM_DIR, "/", B2_cutrunbamFiles)
all_epi_signal <- c(B1_epi_signalFiles, B2_epi_signalFiles)
all_sampleID <- c(B1_sample_ID, B2_sample_ID)
all_peaks <- c("T0hr_CTL_H3K4me3_A_peaks.bed", "T0hr_CTL_H3K4me3_B_peaks.bed",
"T0hr_CTL_H3K27me3_A_peaks.bed", "T0hr_CTL_H3K27me3_B_peaks.bed",
"T0hr_CTL_H3K27ac_A_peaks.bed", "T0hr_CTL_H3K27ac_B_peaks.bed",
"T0.5hr_CTL_H3K4me3_A_peaks.bed", "T0.5hr_CTL_H3K4me3_B_peaks.bed",
"T0.5hr_CTL_H3K27me3_A_peaks.bed", "T0.5hr_CTL_H3K27me3_B_peaks.bed",
"T0.5hr_CTL_H3K27ac_A_peaks.bed", "T0.5hr_CTL_H3K27ac_B_peaks.bed",
"T4hr_CTL_H3K4me3_A_peaks.bed", "T4hr_CTL_H3K4me3_B_peaks.bed",
"T4hr_CTL_H3K27me3_A_peaks.bed",
"T4hr_CTL_H3K27ac_A_peaks.bed", "T4hr_CTL_H3K27ac_B_peaks.bed",
"T24hr_CTL_H3K4me3_A_peaks.bed", "T24hr_CTL_H3K4me3_B_peaks.bed",
"T24hr_CTL_H3K27me3_A_peaks.bed", "T24hr_CTL_H3K27me3_B_peaks.bed",
"T24hr_CTL_H3K27ac_A_peaks.bed", "T24hr_CTL_H3K27ac_B_peaks.bed",
"T48hr_CTL_H3K4me3_A_peaks.bed", "T48hr_CTL_H3K4me3_B_peaks.bed",
"T48hr_CTL_H3K27me3_A_peaks.bed", "T48hr_CTL_H3K27me3_B_peaks.bed",
"T48hr_CTL_H3K27ac_A_peaks.bed", "T48hr_CTL_H3K27ac_B_peaks.bed",
"T0hr_CTL_b2_H3K27ac_A_peaks.bed", "T0hr_CTL_b2_H3K27ac_B_peaks.bed",
"T0hr_CTL_b2_H3K27me3_A_peaks.bed", "T0hr_CTL_b2_H3K27me3_B_peaks.bed",
"T4hr_CTL_b2_H3K27ac_A_peaks.bed", "T4hr_CTL_b2_H3K27ac_B_peaks.bed",
"T4hr_CTL_b2_H3K27me3_A_peaks.bed", "T4hr_CTL_b2_H3K27me3_B_peaks.bed",
"T4hr_CB839_b2_H3K27ac_A_peaks.bed", "T4hr_CB839_b2_H3K27ac_B_peaks.bed",
"T4hr_CB839_b2_H3K27me3_A_peaks.bed", "T4hr_CB839_b2_H3K27me3_B_peaks.bed",
"T4hr_DON_b2_H3K27ac_A_peaks.bed", "T4hr_DON_b2_H3K27ac_B_peaks.bed",
"T4hr_DON_b2_H3K27me3_A_peaks.bed", "T4hr_DON_b2_H3K27me3_B_peaks.bed",
"T4hr_NoQ_b2_H3K27ac_A_peaks.bed", "T4hr_NoQ_b2_H3K27ac_B_peaks.bed",
"T4hr_NoQ_b2_H3K27me3_A_peaks.bed", "T4hr_NoQ_b2_H3K27me3_B_peaks.bed",
"T24hr_CTL_b2_H3K27ac_A_peaks.bed", "T24hr_CTL_b2_H3K27ac_B_peaks.bed",
"T24hr_CTL_b2_H3K27me3_A_peaks.bed", "T24hr_CTL_b2_H3K27me3_B_peaks.bed",
"T24hr_CB839_b2_H3K27ac_A_peaks.bed", "T24hr_CB839_b2_H3K27ac_B_peaks.bed",
"T24hr_CB839_b2_H3K27me3_A_peaks.bed", "T24hr_CB839_b2_H3K27me3_B_peaks.bed",
"T24hr_DON_b2_H3K27ac_A_peaks.bed", "T24hr_DON_b2_H3K27ac_B_peaks.bed",
"T24hr_DON_b2_H3K27me3_A_peaks.bed", "T24hr_DON_b2_H3K27me3_B_peaks.bed",
"T24hr_NoQ_b2_H3K27ac_A_peaks.bed", "T24hr_NoQ_b2_H3K27ac_B_peaks.bed",
"T24hr_NoQ_b2_H3K27me3_A_peaks.bed", "T24hr_NoQ_b2_H3K27me3_B_peaks.bed",
"T48hr_CTL_b2_H3K27ac_A_peaks.bed", "T48hr_CTL_b2_H3K27ac_B_peaks.bed",
"T48hr_CTL_b2_H3K27me3_A_peaks.bed", "T48hr_CTL_b2_H3K27me3_B_peaks.bed",
"T48hr_CB839_b2_H3K27ac_A_peaks.bed", "T48hr_CB839_b2_H3K27ac_B_peaks.bed",
"T48hr_CB839_b2_H3K27me3_A_peaks.bed", "T48hr_CB839_b2_H3K27me3_B_peaks.bed",
"T48hr_DON_b2_H3K27ac_A_peaks.bed", "T48hr_DON_b2_H3K27ac_B_peaks.bed",
"T48hr_DON_b2_H3K27me3_A_peaks.bed", "T48hr_DON_b2_H3K27me3_B_peaks.bed",
"T48hr_NoQ_b2_H3K27ac_A_peaks.bed", "T48hr_NoQ_b2_H3K27ac_B_peaks.bed",
"T48hr_NoQ_b2_H3K27me3_A_peaks.bed", "T48hr_NoQ_b2_H3K27me3_B_peaks.bed")
all_peaks <- paste0("/home/xiang/DNA_seq/CD8_CUTRUN/all_ChIPseq_aligned/", all_peaks)
CD8_CUTRUN_exp <- data.frame(SampleID = all_sampleID,
bamReads = all_epi_signal,
Timepoints = c(rep(c(0, 0.5), each = 6),
rep(4, 5),
rep(24, 6),
rep(48, 6),
rep(0, 4),
rep(4, 16),
rep(24, 16),
rep(48, 16)),
Treatment = c(rep("CTL", 29),
rep("CTL", 8),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4),
rep("CTL", 4),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4),
rep("CTL", 4),
rep("CB839", 4),
rep("DON", 4),
rep("NoQ", 4)),
Factor = c("H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K4me3", "H3K4me3", "H3K27me3", "H3K27me3", "H3K27ac", "H3K27ac",
"H3K27ac", "H3K27ac", "H3K27me3", "H3K27me3",
"H3K27ac", "H3K27ac", "H3K27me3", "H3K27me3"),
replicates = c(1,2, 1,2, 1,2,
1,2, 1,2, 1,2,
1,2, 1,   1,2,
1,2, 1,2, 1,2,
3,4, 3,4,
1,2, 1,2,
3,4, 3,4,
1,2, 1,2,
3,4, 3,4,
1,2, 1,2,
1,2, 1,2),
Peaks = all_peaks)
write.csv(CD8_CUTRUN_exp, file = "CD8_CUTRUN_exp.csv", row.names = FALSE)
